filebeat:

  inputs:
    - type: log
      paths:
        - /var/log/jetty/*/*/*.log
      document_type: jetty
      close_inactive: 30m
      close_timeout: 5m
      ignore_older: 12h
      multiline:
        pattern: '^[[:space:]]'
        negate: false
        match: after
      exclude_lines: ['HEAD /.*/OK HTTP/1.0" 200 ', "2Strapp-*"]
    - type: log
      paths:
        - /var/log/jetty/*/*/*.json
      document_type: jetty
      close_inactive: 30m
      close_timeout: 5m
      ignore_older: 12h
      json:
        keys_under_root: true
      fields:
        log_system: "jetty"
        log_format: "json"

processors:
  - dissect:
      when:
        equals:
          fields.log_system: "jetty"
      tokenizer: "/var/log/jetty/%{category}-%{stage}/%{program}/%{logfile}"
      field: "log.file.path"
      target_prefix: ''
#  - dissect:
#      when:
#        contains:
#          log.file.path: "/auth/server.log"
#      tokenizer: "${timestamp} (logref ${requestLogRef}.${sessionLogRef}) ${loglevel} [${class}] (${thread}) ${message}"
#      field: "log.file.path"
#      target_prefix: ''

logging:
  level: debug
  to_files: false


output:
  logstash:
    hosts: [ "192.168.0.12:5044" ]
